# üíæ –í–æ–∫–∑–∞–ª.–¢–ï–• ‚Äî –ü–ª–∞–Ω —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

## üéØ –¶–µ–ª—å
–û–±–µ—Å–ø–µ—á–∏—Ç—å:
- –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º 152-–§–ó (—Ö—Ä–∞–Ω–µ–Ω–∏–µ 1 –≥–æ–¥)

---

## üì¶ –ß—Ç–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç—Å—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ß–∞—Å—Ç–æ—Ç–∞ | –ú–µ—Ç–æ–¥ | –•—Ä–∞–Ω–µ–Ω–∏–µ |
|----------|--------|-------|---------|
| **PostgreSQL** | –ö–∞–∂–¥—ã–µ 4 —á–∞—Å–∞ | `pg_dump` + WAL | MinIO + –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä |
| **Redis** | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ | RDB + AOF | MinIO |
| **–î–æ–∫—É–º–µ–Ω—Ç—ã** | –ü–æ—Å—Ç–æ—è–Ω–Ω–æ | Rsync | MinIO + S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** | –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ | Git | GitHub |
| **–õ–æ–≥–∏** | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ | Loki | MinIO + –∞—Ä—Ö–∏–≤ |
| **–°–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (—à–∞–±–ª–æ–Ω—ã, –ø–µ—Ä–µ–≤–æ–¥—ã) | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ | Tar + Gzip | MinIO |

---

## üîÑ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. **–ü–æ–ª–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –†–∞–∑ –≤ —Å—É—Ç–∫–∏ (–≤ 02:00)
- –í—Å—ë: –ë–î, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ª–æ–≥–∏
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: `gpg --encrypt`

### 2. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –ö–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
- –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `rsync` –∏ `WAL-G` –¥–ª—è PostgreSQL

### 3. **–•—Ä–∞–Ω–µ–Ω–∏–µ**
- **–û—Å–Ω–æ–≤–Ω–æ–µ:** MinIO (–ª–æ–∫–∞–ª—å–Ω–æ)
- **–†–µ–∑–µ—Ä–≤–Ω–æ–µ:** –í–Ω–µ—à–Ω–µ–µ S3-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Selectel)
- **–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è:** 365 –¥–Ω–µ–π

---

## üß∞ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **WAL-G** ‚Äî –¥–ª—è PostgreSQL
- **Restic** ‚Äî –¥–ª—è –æ–±—â–µ–≥–æ –±—ç–∫–∞–ø–∞
- **MinIO** ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **BorgBackup** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

---

## üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### 1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ PostgreSQL
```bash
# –°–∫–∞—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø
wget https://backup.vokzal.tech/db/latest.dump.gpg
gpg --decrypt latest.dump.gpg | pg_restore -U vokzal -d vokzal_db
2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤rsync -av backup.vokzal.tech:/documents/ /var/vokzal/documents/
3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–πgit clone https://github.com/vokzal-tech/infra-config
kubectl apply -f .
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
–†–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª ‚Äî –ø–æ–ª–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ä–µ–¥—É
–ü—Ä–æ–≤–µ—Ä–∫–∞:

–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
–†–∞–±–æ—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞
–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 54-–§–ó


üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
‚úÖ –õ–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è 1 –≥–æ–¥
‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
‚úÖ –†–µ–∑–µ—Ä–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–æ—Å—Ç—É–ø–Ω–æ
‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ
‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω –∞–∫—Ç –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞
–†–µ–∑–µ—Ä–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ: backup.vokzal.tech
–ö–æ–Ω—Ç–∞–∫—Ç: backup@vokzal.tech
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://docs.vokzal.tech/backup
