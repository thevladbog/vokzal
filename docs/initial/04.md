# üß± –í–æ–∫–∑–∞–ª.–¢–ï–• ‚Äî –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

## üìÇ –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

### 1. `Station` (–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª)
```sql
station_id      UUID (PK)
name            VARCHAR(100)    -- "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π"
code            VARCHAR(10)     -- "ROSTOV"
address         TEXT
timezone        VARCHAR(50)     -- "Europe/Moscow"
created_at      TIMESTAMP
updated_at      TIMESTAMP
2. Bus (–ê–≤—Ç–æ–±—É—Å)bus_id          UUID (PK)
plate_number    VARCHAR(12)     -- "–ê123–ë–í 777"
model           VARCHAR(50)     -- "–ú–ê–ó 251"
capacity        INT             -- 45
status          ENUM('active', 'maintenance', 'out_of_service')
station_id      UUID (FK)       -- –±–∞–∑–æ–≤—ã–π –≤–æ–∫–∑–∞–ª
created_at      TIMESTAMP
updated_at      TIMESTAMP
3. Driver (–í–æ–¥–∏—Ç–µ–ª—å)driver_id       UUID (PK)
full_name       VARCHAR(100)
license_number  VARCHAR(20)
experience_years INT
phone           VARCHAR(15)
station_id      UUID (FK)
created_at      TIMESTAMP
updated_at      TIMESTAMP
4. Route (–ú–∞—Ä—à—Ä—É—Ç)route_id        UUID (PK)
name            VARCHAR(100)    -- "–†–æ—Å—Ç–æ–≤ ‚Üí –ö–∞–∑–∞–Ω—å"
stops           JSONB           -- [{ station_id, order, arrival_offset_min }]
distance_km     DECIMAL(8,2)
duration_min    INT
is_active       BOOLEAN
created_at      TIMESTAMP
updated_at      TIMESTAMP
5. Schedule (–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ)schedule_id     UUID (PK)
route_id        UUID (FK)
departure_time  TIME
days_of_week    JSONB           -- [1, 3, 5] ‚Äî –ø–Ω, —Å—Ä, –ø—Ç
platform        VARCHAR(10)     -- "–ü–µ—Ä—Ä–æ–Ω 3"
is_active       BOOLEAN
created_at      TIMESTAMP
updated_at      TIMESTAMP
6. Trip (–†–µ–π—Å ‚Äî —ç–∫–∑–µ–º–ø–ª—è—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è)trip_id         UUID (PK)
schedule_id     UUID (FK)
date            DATE
status          ENUM('scheduled', 'delayed', 'cancelled', 'departed', 'arrived')
delay_minutes   INT
platform        VARCHAR(10)
departure_actual TIMESTAMP
arrival_actual  TIMESTAMP
bus_id          UUID (FK)
driver_id       UUID (FK)
created_at      TIMESTAMP
updated_at      TIMESTAMP
7. Seat (–ú–µ—Å—Ç–æ)seat_id         UUID (PK)
bus_id          UUID (FK)
number          INT             -- 1‚Äì45
type            ENUM('regular', 'vip', 'disabled', 'near_exit')
is_available    BOOLEAN
created_at      TIMESTAMP
updated_at      TIMESTAMP
8. Ticket (–ë–∏–ª–µ—Ç)ticket_id       UUID (PK)
trip_id         UUID (FK)
seat_id         UUID (FK)       -- NULL, –µ—Å–ª–∏ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞
passenger_name  VARCHAR(100)    -- NULL, –µ—Å–ª–∏ –∞–Ω–æ–Ω–∏–º–Ω—ã–π
passport        VARCHAR(20)     -- –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
price           DECIMAL(10,2)
status          ENUM('active', 'returned', 'used')
return_penalty  DECIMAL(10,2)   -- —à—Ç—Ä–∞—Ñ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
sold_at         TIMESTAMP
sold_by         UUID (FK ‚Üí User)
station_id      UUID (FK)
created_at      TIMESTAMP
updated_at      TIMESTAMP
9. BlockingRule (–ü—Ä–∞–≤–∏–ª–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–µ—Å—Ç)rule_id         UUID (PK)
station_id      UUID (FK)
route_id        UUID (FK)
seat_range      VARCHAR(20)     -- "40-45"
reason          ENUM('station_lock', 'privileged', 'maintenance')
valid_from      DATE
valid_to        DATE
created_at      TIMESTAMP
updated_at      TIMESTAMP
10. DocumentTemplate (–®–∞–±–ª–æ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–∞)template_id     UUID (PK)
name            VARCHAR(100)    -- "–ü–æ—Å–∞–¥–æ—á–Ω–∞—è –≤–µ–¥–æ–º–æ—Å—Ç—å (–ü–î-2)"
content         TEXT            -- HTML —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏: {{trip_id}}, {{passengers}}
format          ENUM('pdf', 'docx')
is_default      BOOLEAN
created_at      TIMESTAMP
updated_at      TIMESTAMP
üîÑ –°–≤—è–∑–∏
Station ‚Üí Bus, Driver, Trip, Ticket, BlockingRule
Route ‚Üí Schedule ‚Üí Trip
Trip ‚Üí Ticket, Seat (—á–µ—Ä–µ–∑ ticket.seat_id)
User (–∫–∞—Å—Å–∏—Ä, –¥–∏—Å–ø–µ—Ç—á–µ—Ä) ‚Üí Ticket.sold_by, AuditLog.user_id
üìä –ò–Ω–¥–µ–∫—Å—ã (–∫–ª—é—á–µ–≤—ã–µ)
ticket(trip_id, seat_id) ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏
trip(schedule_id, date) ‚Äî –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
audit_log(entity_type, entity_id) ‚Äî –¥–ª—è –∞—É–¥–∏—Ç–∞
blocking_rule(route_id, station_id) ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
