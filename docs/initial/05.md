# üîÑ –í–æ–∫–∑–∞–ª.–¢–ï–• ‚Äî API

## üåê –ë–∞–∑–æ–≤—ã–π URL
https://api.vokzal.tech/v1
–í—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API Gateway —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/v1`.  
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: **JWT Bearer Token**.

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### `POST /auth/login`
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "username": "kassir1",
  "password": "secret",
  "station_id": "rostov"
}
–û—Ç–≤–µ—Ç:{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxx",
  "user": {
    "id": "u123",
    "role": "cashier",
    "station_id": "rostov",
    "full_name": "–ò–≤–∞–Ω –ö–∞—Å—Å–∏—Ä–æ–≤"
  }
}
üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç—ã –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µGET /routes–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã.–û—Ç–≤–µ—Ç:[
  {
    "route_id": "r1",
    "name": "–†–æ—Å—Ç–æ–≤ ‚Üí –ö–∞–∑–∞–Ω—å",
    "stops": [
      { "station_id": "rostov", "order": 1 },
      { "station_id": "volgograd", "order": 2 },
      { "station_id": "kazan", "order": 3 }
    ],
    "distance_km": 1020,
    "duration_min": 780
  }
]
GET /schedules?route_id=r1&date=2025-04-10–ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–π—Å–æ–≤ –Ω–∞ –¥–∞—Ç—É.–û—Ç–≤–µ—Ç:[
  {
    "trip_id": "t1",
    "schedule_id": "s1",
    "date": "2025-04-10",
    "departure_time": "08:00",
    "status": "scheduled",
    "delay_minutes": 0,
    "platform": "–ü–µ—Ä—Ä–æ–Ω 3",
    "bus": { "plate_number": "–ê123–ë–í" },
    "driver": { "full_name": "–ü–µ—Ç—Ä–æ–≤ –ê.–ê." },
    "available_seats": 12
  }
]
üé´ –ü—Ä–æ–¥–∞–∂–∞ –±–∏–ª–µ—Ç–æ–≤POST /tickets/sell–ü—Ä–æ–¥–∞–∂–∞ –±–∏–ª–µ—Ç–∞.–ó–∞–ø—Ä–æ—Å:{
  "trip_id": "t1",
  "seat_id": "s5",        // null ‚Äî –µ—Å–ª–∏ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –º–µ—Å—Ç–∞
  "passenger_name": "–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞",  // null ‚Äî –µ—Å–ª–∏ –∞–Ω–æ–Ω–∏–º–Ω—ã–π
  "passport": "4500 123456",
  "payment_method": "card"
}
–û—Ç–≤–µ—Ç:{
  "ticket_id": "tk123",
  "qr_code": "https://vokzal.tech/t/tk123",
  "price": 1500.00,
  "fiscal_receipt_url": "https://ofd.atol.ru/receipt/123"
}
POST /tickets/return–í–æ–∑–≤—Ä–∞—Ç –±–∏–ª–µ—Ç–∞.–ó–∞–ø—Ä–æ—Å:{
  "ticket_id": "tk123",
  "reason": "–ù–µ –ø—Ä–∏–µ—Ö–∞–ª"
}
–û—Ç–≤–µ—Ç:{
  "success": true,
  "refunded_amount": 1350.00,
  "penalty": 150.00,
  "fiscal_receipt_url": "https://ofd.atol.ru/receipt/124"
}
üìã –ü–æ—Å–∞–¥–∫–∞POST /boarding/start–ù–∞—á–∞—Ç—å –ø–æ—Å–∞–¥–∫—É –Ω–∞ —Ä–µ–π—Å.–ó–∞–ø—Ä–æ—Å:{
  "trip_id": "t1"
}
–û—Ç–≤–µ—Ç:{
  "success": true,
  "message": "–í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Ä–µ–π—Å–∞ t1"
}
POST /boarding/mark–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ—Å–∞–¥–∫—É.–ó–∞–ø—Ä–æ—Å:{
  "ticket_id": "tk123",
  "confirmed": true
}
–û—Ç–≤–µ—Ç:{
  "success": true
}
üì¢ –¢–∞–±–ª–æ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µGET /board/public–î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—â–µ–≥–æ —Ç–∞–±–ª–æ.–û—Ç–≤–µ—Ç:{
  "departures": [
    {
      "trip_id": "t1",
      "route": "–†–æ—Å—Ç–æ–≤ ‚Üí –ö–∞–∑–∞–Ω—å",
      "departure_time": "08:00",
      "platform": "–ü–µ—Ä—Ä–æ–Ω 3",
      "status": "–ó–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 15 –º–∏–Ω"
    }
  ]
}
POST /announcements–î–æ–±–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ.–ó–∞–ø—Ä–æ—Å:{
  "text": "–†–µ–π—Å –≤ –ö–∞–∑–∞–Ω—å –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 15 –º–∏–Ω—É—Ç. –ü–æ—Å–∞–¥–∫–∞ –Ω–∞—á–Ω—ë—Ç—Å—è —É –ø–µ—Ä—Ä–æ–Ω–∞ 3.",
  "priority": "high"
}
–û—Ç–≤–µ—Ç:{
  "announcement_id": "a1",
  "status": "queued"
}
üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ãGET /documents/pd2?trip_id=t1–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–∞–¥–æ—á–Ω—É—é –≤–µ–¥–æ–º–æ—Å—Ç—å (–ü–î-2).–û—Ç–≤–µ—Ç:
PDF-—Ñ–∞–π–ª —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–æ–π.POST /documents/custom–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ —à–∞–±–ª–æ–Ω—É.–ó–∞–ø—Ä–æ—Å:{
  "template_id": "tpl1",
  "data": {
    "trip_id": "t1",
    "driver": "–ü–µ—Ç—Ä–æ–≤ –ê.–ê."
  }
}
–û—Ç–≤–µ—Ç:
PDF/DOCX —Ñ–∞–π–ª.üì¶ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –≤–æ–∫–∑–∞–ª–∞–º–∏POST /sync/trip-status–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä–µ–π—Å–∞ –Ω–∞ –¥—Ä—É–≥–æ–º –≤–æ–∫–∑–∞–ª–µ.–ó–∞–ø—Ä–æ—Å:{
  "trip_id": "t1",
  "station_id": "volgograd",
  "status": "arrived",
  "arrival_actual": "2025-04-10T14:22:00"
}
–û—Ç–≤–µ—Ç:{
  "success": true
}
